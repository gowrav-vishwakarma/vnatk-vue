<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Gowrav Vishwakarma">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Sequelize Model Features - VNATK-VUE</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Sequelize Model Features";
    var mkdocs_page_input_path = "sequelize-model-features.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> VNATK-VUE</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../quickstart/">QuickStart</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Components</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../components/">List</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../components/CRUD/">vnatk-crud component</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../using-vnatk-with-vuetify/">Using VES with Vuetify</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Sequelize Model Features</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#model-specific">Model Specific</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#titlefield">titlefield</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#vnatkgetactions">vnAtkGetActions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#field-specific">Field Specific</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#caption">caption</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ext">ext</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#ui">ui</a>
    </li>
        </ul>
    </li>
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">VNATK-VUE</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Sequelize Model Features</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/gowrav-vishwakarma/vnatk-vue/edit/master/docs/sequelize-model-features.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="aditional-model-features">Aditional Model Features</h1>
<p>If you are using VES (vnatk-express-sequelize) as your API powerhouse only, you can keep using Sequelize model system and it will work fine. But if you are using <code>vantk-vue</code>, you can add some more features on your sequelize models to automate a few things here on frontend.</p>
<h2 id="model-specific">Model Specific</h2>
<h3 id="titlefield">titlefield</h3>
<p><code>Class Property</code> <code>[Optional]</code> - <code>default name</code></p>
<p>VES will de-reference all realtions and try to find proper name to idetify related record. Default, it assumes your <code>name</code> field if defined in model is your title field.</p>
<p>If, <code>User belongsTo City</code>, we have <code>CityId</code> in <code>Users</code> Table. if City has name field, VNATK will show City's name in data grid etc and even in autocomplete dropdown to type, while when saving its appropriate Id will be saved in User.</p>
<p>But, if you have different field in Model that defines name for that record like <code>identifier</code> in Products table. you can create <code>titlefield</code> property to be value <code>identifier</code>, And rest VNATK will doing de-referencing with this field now.</p>
<p>example </p>
<pre><code class="language-javascript">module.exports = (sequelize, DataTypes) =&gt; {
    const Project = sequelize.define('Project', {
        // This field is supposed to be titlefield
        code: DataTypes.STRING,
        title: DataTypes.STRING,
        imageUrl: DataTypes.STRING,
        description: DataTypes.TEXT,
        adminId: DataTypes.INTEGER
    }, {});

    // This is how you define your title field for model
    Project.titlefield = 'code';

    Project.associate = function (models) {
        Project.belongsTo(models.User, {
            foreignKey: 'adminId',
            onDelete: 'CASCADE',
            as: 'ProjectAdmin'
        })
        Project.belongsToMany(models.User, {
            foreignKey: 'adminId',
            onDelete: 'CASCADE',
            as: 'ProjectUsers',
            through: models.UserProjects
        })
    };
    return Project;
};
</code></pre>
<h3 id="vnatkgetactions">vnAtkGetActions</h3>
<p><code>Class Method</code></p>
<p>If defined this method returns various actions doable on records based on condition at vantk-crud frontend.</p>
<pre><code class="language-javascript">
module.exports = (sequelize, DataTypes) =&gt; {
    const Project = sequelize.define('Project', {
        // This field is supposed to be titlefield
        code: DataTypes.STRING,
        title: DataTypes.STRING,
        imageUrl: DataTypes.STRING,
        description: DataTypes.TEXT,
        adminId: DataTypes.INTEGER
    }, {});

    // This is how you define your title field for model
    Project.titlefield = 'code';

    Project.associate = function (models) {
        Project.belongsTo(models.User, {
            foreignKey: 'adminId',
            onDelete: 'CASCADE',
            as: 'ProjectAdmin'
        })
        Project.belongsToMany(models.User, {
            foreignKey: 'adminId',
            onDelete: 'CASCADE',
            as: 'ProjectUsers',
            through: models.UserProjects
        })
    };

    Project.vnAtkGetActions = function (models) {
        return [{
            name: &quot;deactivate&quot;, // identifier of action
            type: 'single', // type Single, NoRecord, MultiRecord
            where: { // Condition to show action on frontend
                status: 'Active'
            },
            execute: 'deActivate' // Model instance method to be called 
        },
        {
            name: &quot;activate&quot;,
            type: 'single',
            where: {
                status: 'InActive'
            },
            execute: 'Activate'
        },
        {
            name: &quot;doSomething&quot;,
            type: 'single',
            where: {
                status: 'InActive'
            },
            formschema: { // pass formschema to display a form on action btn click and receive the data in method below
                &quot;name&quot;: {
                    &quot;type&quot;: &quot;text&quot;,
                    &quot;label&quot;: &quot;name&quot;
                },
                &quot;password&quot;: {
                    &quot;type&quot;: &quot;password&quot;,
                    &quot;clearable&quot;: true,
                    &quot;solo&quot;: true,
                    &quot;class&quot;: &quot;mx-1 mt-1&quot;
                },
            },
            execute: 'doSomething'
        },
        ];
    };

    Project.prototype.deActivate = async function () {
        this.status = 'InActive'
        return await this.save().then(self =&gt; {
            return self;
        });
    };

    Project.prototype.Activate = async function () {
        this.status = 'Active'
        return await this.save().then(self =&gt; {
            return self;
        });
    };
    Project.prototype.doSomething = function (formData) {
        console.log(formData);
    };

    return Project;
};
</code></pre>
<p>Action type can be one of three </p>
<ul>
<li><code>Single</code> - Performable on one record, record will be loaded before executing, on frontend, these action will be displayed at row level. like activate/deactivate etc.</li>
<li><code>NoRecord</code> - Performable on NO record, Will be executed on non-loaded models, like <code>vnatk_add</code> etc</li>
<li><code>MultiRecord</code> - Under development, when used, Crud grid will have selection options, and all selected recrods will be available in propert 'vnatk_selected_records' of function argument.</li>
</ul>
<p>To study more about formschema please read more at <a href="https://github.com/wotamann/vuetify-form-base">Vuetify-Form-Base</a></p>
<h2 id="field-specific">Field Specific</h2>
<p>Field specific features/properties can be added on field to effect frontend display</p>
<h3 id="caption">caption</h3>
<p><code>String</code></p>
<p>if specified will show better caption for field like </p>
<pre><code class="language-javascript">
    .
    .
    .
    isDumped: {
        type: DataType.Boolean,
        caption: 'Dumped Project'
    }
    .
    .
    .

</code></pre>
<h3 id="ext">ext</h3>
<p><code>String</code></p>
<p><a href="https://github.com/wotamann/vuetify-form-base">Vuetify-Form-Base</a> specific attribute, please read more at Vuetify-Form-base for more.</p>
<h3 id="ui">ui</h3>
<p><code>JSON</code></p>
<p>VES try to guess best ui information from model, but you can pass the ui property in field itself and VES will just return this without trying to guess best ui header.</p>
<pre><code class="language-javascript">
    .
    .
    .
    isDumped: {
        type: DataType.Boolean,
        ui: {
            type: 'Checkbox',
            text: 'Dumped Project'
        }
    }
    .
    .
    .

</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../using-vnatk-with-vuetify/" class="btn btn-neutral" title="Using VES with Vuetify"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/gowrav-vishwakarma/vnatk-vue/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../using-vnatk-with-vuetify/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
